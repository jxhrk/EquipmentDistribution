# Программа для распределения оборудования
Работу выполнил Горбунов Глеб 4ИСП9-35

Программа позволяет выбрать модель школы, загрузить .xlsx файл с оборудованием, рассчитать необходимое количество оборудования для заданной модели и экспортировать результат в файл .xlsx.
Также есть возможность рачитать изменненную модель на основе существующих. Изменяя количество паралеллей классов, будет рассчитываться количество необходимых кабинетов.

Модели школ и список возможных кабинетов хранятся в формате JSON, их можно изменить и добавить новые в текстовом редакторе. Данные о нагрузке учащихся тоже хранятся в JSON, могут быть изменены как в текстовом редакторе, так и в окне расчета модели. Подробнее об этом в секции ниже.

Данные о нагрузке основаны на [примерах расписания](https://docs.edu.gov.ru/document/e00a63b7adf590197e3776ab3d115552/) Министерства просвещения РФ.

Программа собрана для Windows и Linux.

Окно расчета оборудования:
![screenshot.png](screenshot.png)
Окно расчета модели:
![screenshot2.png](screenshot2.png)

## Запуск
1. Скачать архив с программой со страницы [Releases](https://github.com/jxhrk/EquipmentDistribution/releases)
2. Распаковать архив
3. Запустить файл EquipmentDistribution.exe для Windows и EquipmentDistribution для Linux

## Изменение моделей

Список кабинетов (classrooms.json) хранит возможные названия кабинетов и их ключевые слова для поиска в столбце "Помещение" .xlsx таблицы.

```json
{
  "Classrooms": [
    {
      "Name": "Биология и ОБЗР",
      "Aliases": [
        "биологи",
        "обзр",
        "безопасн",
        "родин"
      ]
    },
    {
      "Name": "Химия",
      "Aliases": [
        "химия",
        "химии"
      ]
    }
  ]
}
```

Виды зданий хранятся в папке SchoolsModels и содержат модели данного вида, а модели - количество предусмотренных в ней кабинетов и параллелей классов.
Названия кабинетов должны соответствовать названиям из файла classrooms.json

```json
{
  "Name": "Вертолёт",
  "Models": [
    {
      "Name": "1-6",
      "Classes": {
        "1": 4,
        "2": 6,
        "3": 6,
        "4": 6,
        "5": 6,
        "6": 6,
        "7": 0,
        "8": 0,
        "9": 0,
        "10": 0,
        "11": 0
      },
      "Classrooms": {
        "Универсальный": 32,
        "Иностранный язык": 4,
        "Биология и ОБЗР": 1,
        "Физика": 0,
        "Химия": 0,
        "Технология информационная": 0,
        "Технология материальная": 2,
        "Информатика": 1
      }
    },
    {
      "Name": "5-11",
      "Classes": {
        "1": 0,
        "2": 0,
        "3": 0,
        "4": 0,
        "5": 7,
        "6": 7,
        "7": 7,
        "8": 7,
        "9": 7,
        "10": 3,
        "11": 3
      },
      "Classrooms": {
        "Универсальный": 27,
        "Иностранный язык": 4,
        "Биология и ОБЗР": 3,
        "Физика": 2,
        "Химия": 1,
        "Технология информационная": 1,
        "Технология материальная": 2,
        "Информатика": 2
      }
    }
  ]
}
```

Количество часов для каждого класса и предмета хранится в следующем формате (learning_hours.json):
```json
{
  "Classes": [
    {
      "Year": 1,
      "Hours": {
        "Универсальный": 20,
        "Иностранный язык": 0,
        "Биология и ОБЗР": 0,
        "Физика": 0,
        "Химия": 0,
        "Технология информационная": 0,
        "Технология материальная": 1,
        "Информатика": 0
      }
    },
    {
      "Year": 2,
      "Hours": {
        "Универсальный": 18,
        "Иностранный язык": 2,
        "Биология и ОБЗР": 0,
        "Физика": 0,
        "Химия": 0,
        "Технология информационная": 0,
        "Технология материальная": 1,
        "Информатика": 0
      }
    }
  ]
}
```

## Сборка

Собрать возможно с помощью любой среды разработки либо из терминала

### Windows

`dotnet publish -r win-x64 -p:PublishSingleFile=true --self-contained true`

### Linux

`dotnet publish -r linux-x64 -p:PublishSingleFile=true --self-contained true`